<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avances del Proyecto</title>
  <link rel="stylesheet" href="css/estilo.css">
</head>

<body>
  <!-- Header con logo y men√∫ -->
  <header id="inicio">
    <nav>
      <div class="logo">
        <a href="index.html">
          <img src="image/logo2.png" alt="Logo del Proyecto">
        </a>
      </div>
      <ul>
        <li><a href="index.html" class="activo">Inicio</a></li>

        <!-- Men√∫ desplegable Avances -->
        <li class="submenu">
          <a href="avances.html">Avances</a>
          <ul class="submenu-opciones">
            <li><a href="avances1.html">Avance 1</a></li>
            <li><a href="avances2.html">Avance 2</a></li>
            <li><a href="avances3.html">Avance 3</a></li>
          </ul>
        </li>

        <li><a href="equipo.html">Equipo</a></li>
        <li><a href="documentacion.html">Documentaci√≥n T√©cnica</a></li>
      </ul>
    </nav>
  </header>

  <!-- Banner -->
  <section class="banner">
    <img src="image/Servidor..png" alt="Banner avances del proyecto">
    <h1>Avances</h1>
  </section>
  <!-- Secci√≥n de avances -->
  <section class="contenedor-avances">
    <p>
    Durante este per√≠odo, el equipo continu√≥ trabajando en la integraci√≥n del sensor de temperatura y humedad 
    <strong>DHT11</strong>, la pantalla <strong>OLED 0.96"</strong> y el microcontrolador <strong>ESP32</strong>, 
    avanzando significativamente en el desarrollo del sistema.
  </p>

  <p>
    En primer lugar, se logr√≥ ejecutar correctamente el c√≥digo en el entorno <strong>Arduino IDE</strong> sin presentar 
    errores de compilaci√≥n, lo que permiti√≥ avanzar en el √°rea de programaci√≥n del sensor y la pantalla OLED.
  </p>

  <p>
    Con la ayuda de ChatGPT, el equipo obtuvo y adapt√≥ un c√≥digo funcional que permite leer la temperatura y la humedad 
    mediante el sensor DHT11 y mostrar los valores en la pantalla OLED.
  </p><br>

  <h3>C√≥digo Utilizado</h3>

  <pre><code>
#include &lt;SPI.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_SSD1306.h&gt;
#include "DHT.h"

// -------- CONFIGURACI√ìN OLED (SPI) --------
#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_MOSI 23
#define OLED_CLK 18
#define OLED_DC 25
#define OLED_CS 32
#define OLED_RESET 21

Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &SPI, OLED_DC, OLED_RESET, OLED_CS);

// -------- CONFIGURACI√ìN DHT11 --------
#define DHTPIN 4       // Pin del ESP32 conectado al DHT11
#define DHTTYPE DHT11  // Tipo de sensor
DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);
  Serial.println("Iniciando sistema...");

  // Iniciar OLED
  if (!display.begin(SSD1306_SWITCHCAPVCC)) {
    Serial.println("‚ùå No se encontr√≥ la pantalla OLED");
    for (;;);
  }

  // Iniciar DHT11
  dht.begin();

  // Pantalla inicial
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(SSD1306_WHITE);
  display.setCursor(10, 25);
  display.println("Iniciando...");
  display.display();
  delay(2000);
}

void loop() {
  // Leer datos del sensor
  float temp = dht.readTemperature();
  float hum = dht.readHumidity();

  // Verificar si los valores son v√°lidos
  if (isnan(temp) || isnan(hum)) {
    Serial.println("‚ùå Error al leer el sensor DHT11");
    display.clearDisplay();
    display.setTextSize(1);
    display.setCursor(10, 25);
    display.println("Error sensor");
    display.display();
  } else {
    // Mostrar en consola
    Serial.print("Temperatura: ");
    Serial.print(temp);
    Serial.print(" ¬∞C  |  Humedad: ");
    Serial.print(hum);
    Serial.println(" %");

    // Mostrar en OLED
    display.clearDisplay();
    display.setTextColor(SSD1306_WHITE);
    display.setTextSize(1);
    display.setCursor(0, 5);
    display.println("Sensor DHT11");

    display.setTextSize(2);
    display.setCursor(0, 25);
    display.print(temp);
    display.println(" C");

    display.setTextSize(2);
    display.setCursor(0, 50);
    display.print(hum);
    display.println(" %");
    display.display();
  }

  delay(2000); // Actualiza cada 2 segundos
}
  </code></pre>

  <p>
    Posteriormente, se logr√≥ habilitar la conectividad WiFi del ESP32 y se implement√≥ con √©xito la funcionalidad 
    de env√≠o de notificaciones autom√°ticas a trav√©s de <strong>Telegram</strong>, mediante un bot configurado 
    espec√≠ficamente para el proyecto. En esta etapa, el sistema enviaba correctamente la temperatura registrada, 
    aunque inicialmente no mostraba los valores en la pantalla OLED.
  </p>

  <p>
    Tras realizar nuevas pruebas y ajustes, el equipo consigui√≥ hacer funcionar de manera simult√°nea todos los 
    componentes: el sensor, la pantalla OLED y el env√≠o de datos al bot de Telegram, alcanzando as√≠ uno de los 
    principales objetivos del proyecto.
  </p>

  <p>
    De esta forma, el prototipo pudo medir la temperatura y humedad en tiempo real, visualizarlas en pantalla y 
    reportarlas remotamente a trav√©s de Internet.
  </p>

  <p>
    Finalmente, se comenz√≥ a planificar la disposici√≥n f√≠sica y mec√°nica de los componentes (sensor, pantalla y placa ESP32), 
    con el fin de desarrollar una estructura funcional que permita instalar el dispositivo en una sala de servidores, 
    cumpliendo con el prop√≥sito del proyecto: contar con un sistema de monitoreo remoto de temperatura que contribuya 
    al control y mantenimiento del ambiente donde se encuentran los equipos.
  </p><br>
  <h3>C√≥digo final que permite mostrar la temperatura y humedad en la OLED y manda la alerta a Telegram</h3>
  <pre><code>
#include &lt;WiFi.h&gt;
#include &lt;HTTPClient.h&gt;
#include &lt;SPI.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_SSD1306.h&gt;
#include "DHT.h"

// ---------- WIFI ----------
const char* ssid     = "Ceibal-2.4GHz";
const char* password = "";

// ---------- TELEGRAM ----------
String botToken = "";
String chatID   = "";

// ---------- DHT ----------
#define DHTPIN 4
#define DHTTYPE DHT11
DHT dht(DHTPIN, DHTTYPE);

// ---------- OLED (SPI) ----------
#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
#define OLED_MOSI 23
#define OLED_CLK  18
#define OLED_DC   25
#define OLED_CS   32
#define OLED_RESET 21

Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &SPI, OLED_DC, OLED_RESET, OLED_CS);

// ---------- CONFIG ----------
float UMBRAL_TEMP = 20.0;      // ¬∞C
unsigned long PERIODO_MS = 10'000; // 10 s
unsigned long tPrev = 0;

// ---------- helpers ----------
void oledMsg(const String& l1, const String& l2 = "") {
  display.clearDisplay();
  display.setTextColor(SSD1306_WHITE);
  display.setTextSize(1);
  display.setCursor(0, 0);
  display.println(l1);
  display.setTextSize(2);
  display.setCursor(0, 20);
  display.println(l2);
  display.display();
}

void conectarWifi() {
  Serial.print("Conectando a Wi-Fi");
  WiFi.begin(ssid, password);
  uint32_t t0 = millis();
  while (WiFi.status() != WL_CONNECTED) {
    delay(400);
    Serial.print(".");
    if (millis() - t0 > 15000) {
      Serial.println("\n‚ö†Ô∏è Timeout Wi-Fi.");
      return;
    }
  }
  Serial.println("\n‚úÖ Wi-Fi conectado");
  Serial.print("IP: "); Serial.println(WiFi.localIP());
}

void enviarTelegram(const String& msg) {
  if (WiFi.status() != WL_CONNECTED) {
    Serial.println("‚ö†Ô∏è Sin Wi-Fi, no env√≠o Telegram");
    return;
  }
  HTTPClient http;
  String safe = msg; safe.replace(" ", "%20");
  String url = "https://api.telegram.org/bot" + botToken +
              "/sendMessage?chat_id=" + chatID + "&text=" + safe;

  if (http.begin(url)) {
    int code = http.GET();
    if (code > 0) Serial.printf("üì® Telegram HTTP %d\n", code);
    else          Serial.printf("‚ùå Error Telegram: %d\n", code);
    http.end();
  } else {
    Serial.println("‚ùå http.begin() fall√≥");
  }
}

void setup() {
  Serial.begin(115200);
  delay(200);

  conectarWifi();

  SPI.begin(OLED_CLK, -1, OLED_MOSI, OLED_CS);

  if (!display.begin(SSD1306_SWITCHCAPVCC)) {
    Serial.println("‚ùå No se encontr√≥ la OLED SSD1306");
    while (true) delay(10);
  }
  display.clearDisplay();
  display.setTextColor(SSD1306_WHITE);

  dht.begin();

  oledMsg("Sistema listo", WiFi.isConnected() ? WiFi.localIP().toString() : "sin Wi-Fi");
  delay(30000);
}

void loop() {
  if (millis() - tPrev < PERIODO_MS) return;
  tPrev = millis();

  if (WiFi.status() != WL_CONNECTED) conectarWifi();

  float t = dht.readTemperature();
  float h = dht.readHumidity();

  if (isnan(t) || isnan(h)) {
    Serial.println("‚ùå Error lectura DHT11");
    oledMsg("Error lectura", "DHT11");
    return;
  }

  Serial.printf("üå° %.1f C  üíß %.0f %%\n", t, h);

  display.clearDisplay();
  display.setTextColor(SSD1306_WHITE);

  display.setTextSize(1);
  display.setCursor(0, 0);
  display.println("DHT11");

  display.setTextSize(2);
  display.setCursor(0, 16);
  display.printf("%.1f C\n", t);

  display.setTextSize(2);
  display.setCursor(0, 40);
  display.printf("%.0f %%\n", h);
  display.display();

  if (t > UMBRAL_TEMP) {
    enviarTelegram("üö® Alerta: temperatura alta (" + String(t, 1) + " ¬∞C)");
  }
}
  </code></pre><br>
  </section>
    <section class="galeria-fotos">
      <h2>Galer√≠a de Fotos del Proyecto</h2>
    
    <div class="carrusel-container">
      <div class="carrusel-wrapper">
        <div class="carrusel-slides" id="carrusel-slides">
          <div class="slide active">
            <div class="slide-info">
              <h3>Prueba de OLED encendido y alerta por Telegram</h3>
            </div>
            <img src="image/avance3.2.jpeg" alt="OLED encendido" onclick="abrirModal(this)">
          </div>
          
          <div class="slide">
            <div class="slide-info">
              <h3>Alerta por mensaje de Telegram</h3>
              <p>La im√°gen muestra la alerta que llega a Telegram y se pueden ver los cambios de temperatura.</p>
            </div>
            <img src="image/avance3.1.jpeg" alt="OLED funcionando" onclick="abrirModal(this)">
          </div>
          
          <div class="slide">
            <div class="slide-info">
              <h3>Circuito funcionando correctamente</h3>
              <p>Circuito completo, con la OLED mostrando la temperatura y alerta en Telegram.</p>
            </div>
            <img src="image/avance3.3.jpeg" alt="C√≥digo de prueba con LED" onclick="abrirModal(this)">
          </div>
          
          <div class="slide">
            <div class="slide-info">
              <h3></h3>
              <p></p>
            </div>
            <img src="image/avance3.4.jpeg" alt="C√≥digo de prueba para la pantalla OLED" onclick="abrirModal(this)">
          </div>
          
          <div class="slide">
            <div class="slide-info">
              <h3></h3>
              <p></p>
            </div>
            <img src="image/avance3.5.jpeg" alt="C√≥digo para leer temperatura y humedad" onclick="abrirModal(this)">
          </div>
        </div>
        
        <!-- Controles del carrusel -->
        <button class="carrusel-btn prev" onclick="cambiarSlide(-1)">‚ùÆ</button>
        <button class="carrusel-btn next" onclick="cambiarSlide(1)">‚ùØ</button>
        
        <!-- Contador de slides -->
        <div class="carrusel-contador">
          <span id="slide-actual">1</span> de <span id="total-slides">6</span>
        </div>
        
        <!-- Indicadores -->
        <div class="carrusel-indicadores">
          <span class="indicador active" onclick="irASlide(0)"></span>
          <span class="indicador" onclick="irASlide(1)"></span>
          <span class="indicador" onclick="irASlide(2)"></span>
          <span class="indicador" onclick="irASlide(3)"></span>
          <span class="indicador" onclick="irASlide(4)"></span>
          <span class="indicador" onclick="irASlide(5)"></span>
        </div>
        
        <!-- Miniaturas de navegaci√≥n -->
        <div class="carrusel-miniaturas">
          <img src="image/avance3.2.jpeg" alt="Slide 1" onclick="irASlide(0)" class="miniatura active">
          <img src="image/avance3.1.jpeg" alt="Slide 2" onclick="irASlide(1)" class="miniatura">
          <img src="image/avance3.3.jpeg" alt="Slide 3" onclick="irASlide(2)" class="miniatura">
          <img src="image/avance3.4.jpeg" alt="Slide 4" onclick="irASlide(3)" class="miniatura">
          <img src="image/avance3.5.jpeg" alt="Slide 5" onclick="irASlide(4)" class="miniatura">
        </div>
      </div>
    </div>
  </section>
    <!-- Modal para ver im√°genes en grande -->
  <div id="modal-imagen" class="modal" onclick="cerrarModal()">
    <span class="cerrar">&times;</span>
    <img class="modal-contenido" id="imagen-modal">
    <div class="caption" id="caption"></div>
  </div>
  <!-- Footer -->
  <footer>
    <a href="#inicio" class="boton-volver">‚Üë Volver arriba</a>
    <p>&copy; 2025 Proyecto Acad√©mico</p>
  </footer>
  <script>
  let slideIndex = 0;
  const slides = document.querySelectorAll(".slide");
  const indicadores = document.querySelectorAll(".indicador");
  const miniaturas = document.querySelectorAll(".miniatura");
  const totalSlides = slides.length;
  const contadorActual = document.getElementById("slide-actual");
  document.getElementById("total-slides").textContent = totalSlides;

  function mostrarSlide(n) {
    slides.forEach((slide, i) => {
      slide.classList.toggle("active", i === n);
    });
    indicadores.forEach((dot, i) => {
      dot.classList.toggle("active", i === n);
    });
    miniaturas.forEach((thumb, i) => {
      thumb.classList.toggle("active", i === n);
    });
    slideIndex = n;
    contadorActual.textContent = n + 1;
  }

  function cambiarSlide(n) {
    let nuevoIndex = slideIndex + n;
    if (nuevoIndex >= totalSlides) nuevoIndex = 0;
    if (nuevoIndex < 0) nuevoIndex = totalSlides - 1;
    mostrarSlide(nuevoIndex);
  }

  function irASlide(n) {
    mostrarSlide(n);
  }

  // --- Modal para ver imagen en grande ---
  function abrirModal(img) {
    const modal = document.getElementById("modal-imagen");
    const modalImg = document.getElementById("imagen-modal");
    const caption = document.getElementById("caption");

    modal.style.display = "block";
    modalImg.src = img.src;
    caption.textContent = img.alt;
  }

  function cerrarModal() {
    document.getElementById("modal-imagen").style.display = "none";
  }

  // Inicializar primer slide
  mostrarSlide(slideIndex);
</script>
</body>

</html>